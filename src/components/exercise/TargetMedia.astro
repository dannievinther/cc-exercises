---
// import { Image } from "astro:assets";
import { Picture } from "astro:assets";
const {
  index,
  image,
  video,
  isSDA = false,
  videoWidth = 800,
  videoHeight = 600,
} = Astro.props;
// Use lazy loading for all items except first, and preload="none" for videos below fold
const isFirst = index === 1;
---

{
  video ? (
    <picture>
      {isSDA ? (
        <video
          muted
          controls
          playsinline
          preload="none"
          width={videoWidth}
          height={videoHeight}
        >
          <source src={video} type="video/mp4" />
        </video>
      ) : (
        <video
          muted
          loop
          autoplay
          playsinline
          preload={isFirst ? "metadata" : "none"}
          width={videoWidth}
          height={videoHeight}
        >
          <source src={video} type="video/mp4" />
        </video>
      )}
    </picture>
  ) : image ? (
    <Picture
      src={image}
      alt=""
      loading={isFirst ? "eager" : "lazy"}
      fetchpriority={isFirst ? "high" : "low"}
      format="avif"
      formats={["avif", "webp"]}
    />
  ) : null
}

<style>
  :global(picture) {
    padding-inline: calc(var(--space-1) / 2);
  }
  img {
    background: #f1eef5;
  }
</style>
